# phase: script generation
# ========================================
# Phase 1: 台本生成設定
# ========================================

# Claude API設定
model: "claude-sonnet-4-20250514"
max_tokens: 8000
temperature: 0.7

# 台本構造
sections:
  count_min: 5
  count_max: 7
  target_duration_per_section: 120  # 秒（約2分）

# AI動画生成のトリガーキーワード
# これらのキーワードを含むセクションではAI動画を生成
ai_video_trigger_keywords:
  - "戦闘"
  - "決戦"
  - "襲撃"
  - "建設"
  - "革命"
  - "即位"
  - "凱旋"

# プロンプトテンプレート
prompt_template: |
  あなたは歴史解説動画の台本作家です。
  {subject}について、15分（約900秒）の動画台本を作成してください。
  
  ## 要件
  1. 全体を5-7個のセクションに分割
  2. 各セクションは約2分程度（120秒）
  3. 高齢者にも分かりやすい言葉遣い
  4. ナレーションは自然な話し言葉
  5. 重要なシーンでは「AI動画が必要」と判定
  6. **起承転結を意識した構成**
  
  ## 起承転結とBGMの配置（重要）
  動画全体を起承転結で構成し、以下のようにBGMを配置してください：
  
  **BGMの切り替えは2回のみ:**
  1. Opening（起）→ Main（承転）への切り替え
  2. Main（承転）→ Ending（結）への切り替え
  
  **各BGMの使い方:**
  - opening: 最初のセクション（起）のみ - 導入、世界観の提示
  - main: 中盤のセクション（承転）- 物語の展開からクライマックス
  - ending: 最後のセクション（結）- 余韻、しんみりとした締め
  
  **注意:**
  - 同じBGMが連続して使われることが前提
  - mainは複数セクションにまたがってOK
  - 読後感を大切に、endingでしんみりと締める
  
  ## 出力形式（JSON）
  {{
    "title": "動画タイトル",
    "description": "YouTube説明文",
    "sections": [
      {{
        "section_id": 1,
        "title": "セクションタイトル",
        "narration": "ナレーション原稿（自然な話し言葉）",
        "estimated_duration": 120,
        "image_keywords": ["キーワード1", "キーワード2"],
        "atmosphere": "壮大/静か/希望/劇的/悲劇的",
        "requires_ai_video": false,
        "ai_video_prompt": null,
        "bgm_suggestion": "opening"
      }}
    ]
  }}
  
  ## 注意事項
  - 必ずJSON形式で出力
  - ナレーションは読みやすく、句読点を適切に配置
  - 画像キーワードは英語でも可（検索精度向上のため）
  - AI動画が必要な場合、ai_video_promptに具体的な描写を記載
  - **bgm_suggestion は必ず "opening", "main", "ending" のいずれかを指定**

# バリデーション設定
validation:
  min_sections: 4
  max_sections: 8
  min_section_duration: 60
  max_section_duration: 240
  min_total_duration: 600
  max_total_duration: 1200
  
  # BGM切り替え検証
  max_bgm_switches: 2  # 最大2回の切り替え（opening→main→ending）
  require_opening_at_start: true  # 最初のセクションはopeningを推奨
  require_ending_at_end: true  # 最後のセクションはendingを推奨